<!DOCTYPE html>
<head>
    <script src="forge/util.js" type="text/javascript"></script>
    <script src="forge/oids.js" type="text/javascript"></script>
    <script src="forge/asn1.js" type="text/javascript"></script>
    <script src="forge/jsbn.js" type="text/javascript"></script>
    <script src="forge/rsa.js" type="text/javascript"></script>
    <script src="forge/sha1.js" type="text/javascript"></script>
    <script src="forge/md5.js" type="text/javascript"></script>
    <script src="forge/aes.js" type="text/javascript"></script>
    <script src="forge/des.js" type="text/javascript"></script>
    <script src="forge/hmac.js" type="text/javascript"></script>
    <script src="forge/pbkdf2.js" type="text/javascript"></script>
    <script src="forge/pki.js" type="text/javascript"></script>
    <script src="forge/prng.js" type="text/javascript"></script>
    <script src="forge/random.js" type="text/javascript"></script>
    <script src="lib/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="buffer.js" type="text/javascript"></script>
    <script src="public_key.js" type="text/javascript"></script>
    <script src="private_key.js" type="text/javascript"></script>
    <script src="auth_request.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            var private_key = octokey.privateKey($('#privatekey').val());
            private_key.setPassphrase($('#passphrase').val());

            $('#publickey').val(private_key.publicKey().toBase64());

            var auth_request = octokey.authRequest({
                challenge: $('#challenge').val(),
                request_url: $('#request_url').val(),
                username: $('#username').val()
            });
            auth_request.sign(private_key);
            $('#authrequest').val(auth_request.toBase64());
        });
    </script>

    <style type="text/css">
        textarea { width: 600px; height: 150px; }
        input[type=text] { width: 600px; }
    </style>
</head>

<body>
    <h1>SSH pubkey authentication test</h1>
    <form>
        <p>
        <label for="username">Username (UTF-8):</label><br>
        <input type="text" id="username" name="username" value="foo">
        </p>

        <p>
        <label for="challenge">Challenge (base64):</label><br>
        <input type="text" id="challenge" name="challenge" value="KWm5PMQC3UYSFY/xgLimHvLhLcuIdwRZoDm4UfEADO0=">
        </p>

        <p>
        <label for="request_url">Request URL:</label><br>
        <input type="text" id="request_url" name="request_url" value="https://www.example.com/login">
        </p>

        <p>
        <label for="privatekey">Private key (PEM):</label><br>
        <textarea id="privatekey" name="privatekey">-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC8wjLP42FK43SO
aSwTPwsnVXX97WtnSSuIPtN00qj62nbaPyrfIOwiWqb4FIrsAoa97uJgYovDZcTk
BKTzpwLj1rKpQva3elwxFfQcpz4T3jDX+DxODLF36BQSf2QoAsNUTdP12tiDJOgK
2Qqp//+6iZUHtgM/csZckDpMv0uzNn+do4LFm70ddqJYuZ3r/lFoGLAfWLGBmVMW
EajYZWP8CfN8/+LLtQ3DPQ9rK0jPwWZDKa9tOTaqWryk33iv9Ecx1ryHyz1Q0Psg
RixlnaRibr3RKYyFtPl0PBgT92hhrngwWVbkTwOmvvjHCof4D+rV7dUlck+dm9Ss
xTh5MF5BAgMBAAECggEAHyKBMx00XR/rh9n9NSd+9Xv5PGs+/ghpr819H5Xn3YjP
dexZa/iIOpptVBo/V/KKuyV+HZvjpdVRhrLlanMv3Nj7G0Q6YcVDE62lWFyVtr09
nUIK4GzjkP2s4eg1Ywwhn/Q+dB0m/WrHA5MNWUEqs2AiPuVc38hUw8vece5T1Dlu
il7myYgSccIQ5DTbdg/5kMZGcimlOHe4IkaP+RifdhbaWn5c3eOBrKG+uZnauv0B
n6Tb6/DUrKtLKCwWTYwuc9PC1Zgd0/aSyia4KnXrWQuboAhuuOTa4l2E7GaqEe2O
cZiEGTNQpNEEDfT02LIPdTOPCeHUd/AY31fgr2gr4QKBgQDc6EQPDSVCXVzExB6E
9xUhqo+gN3L7N49NZ1qwH4y2i9ttlUSyGbvuc6XL+lWpbIpUu2Rt0rT5ZdjFYJLs
KyepQOO+7Q/YbJ2R+3jLFGO3iFE6R9N8E48NqVjeohzHDpoMb/glN7wPcmT/iBUo
dKpkKnNkSU/f1Bnr4Hi46A0btQKBgQDavob5IihsyDxIkXxdzS+sGWyplxfKOgIN
BiGg3ume1VfEKAixL8MLIXj3S7AOMsS35zJYRZNtr1xQ5Cs9tuYA+mq1xOkQ9hhA
6jmlTawHTi5DvwuLIik95FwQzwckCK4zmS/xdLLtkgtsmbsAjr4LfqX2V/g6OXYk
3kd6IxeH3QKBgAJgWUMUMB9ro7DWL0Hc6pRHIm5lyk3bhiYeA4K7hCb+kCi4n1mP
H09sXQ85rSw6Z66LqYPo7Vt1dgSBinMR78ZJVWnbYP1CBdvpKZ59pKj3xW/sD+FY
0IQkGzmh4s9dX9jcZ333AIXmBCIfk6Kwxph3QHCGvV46COFZs9LBZEq1AoGBAJHH
P/RwizhUCbjjHFr3D7pGB2DOTRB8sDk1yNuJM3CjBaa4d3J+PiIA4LkOO/p6Yxec
gLTLSYFjyMYwCZFLfuVP/iW9YQXovCkm79v2c5s6wyJrA6ppzcptkd2x2zRshIvm
n0jvWP9ywSJTIYkxl/3ZHYma/tbuzImtiT0gfeIRAoGAYktMdBJRRVLzjZvc3XAu
tH8syHcUwlx0C4uQX6kTPmvjI2KupaTVA9UPeRaiq75Gr+bbeND341+cz/lJhlOA
DpqkJEcTmB0nq4Q8/gXdsgqcVG8Is/8ibCyKt3P3rQALgKUlbKG0tZZ/8cb9Axwl
1wLGJfQftS76LNdTph8SVWM=
-----END PRIVATE KEY-----
</textarea>
        </p>

        <p>
        <label for="passphrase">Passphrase:</label><br>
        <input type="text" id="passphrase" name="passphrase" value="password">
        </p>

        <p>
        <label for="publickey">Public key (RFC4253):</label><br>
        <textarea id="publickey" name="publickey"></textarea>
        </p>

        <p>
        <label for="signature">Authentication request (base64):</label><br>
        <textarea id="authrequest" name="authrequest"></textarea>
        </p>
    </form>
</body>
