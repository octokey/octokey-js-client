<!DOCTYPE html>
<head>
    <script src="forge/util.js" type="text/javascript"></script>
    <script src="forge/oids.js" type="text/javascript"></script>
    <script src="forge/asn1.js" type="text/javascript"></script>
    <script src="forge/jsbn.js" type="text/javascript"></script>
    <script src="forge/rsa.js" type="text/javascript"></script>
    <script src="forge/sha1.js" type="text/javascript"></script>
    <script src="forge/md5.js" type="text/javascript"></script>
    <script src="forge/aes.js" type="text/javascript"></script>
    <script src="forge/hmac.js" type="text/javascript"></script>
    <script src="forge/pbkdf2.js" type="text/javascript"></script>
    <script src="forge/pki.js" type="text/javascript"></script>
    <script src="lib/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="buffer.js" type="text/javascript"></script>
    <script src="public_key.js" type="text/javascript"></script>
    <script src="private_key.js" type="text/javascript"></script>
    <script src="auth_request.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            var private_key = octokey.privateKey($('#privatekey').val());
            private_key.setPassphrase($('#passphrase').val());

            $('#publickey').val(private_key.publicKey().toBase64());

            var auth_request = octokey.authRequest({
                challenge: forge.util.hexToBytes($('#challenge').val()),
                request_url: forge.util.encodeUtf8($('#request_url').val()),
                username: forge.util.encodeUtf8($('#username').val())
            });
            auth_request.sign(private_key);
            $('#authrequest').val(auth_request.toBase64());
        });
    </script>

    <style type="text/css">
        textarea { width: 600px; height: 150px; }
        input[type=text] { width: 600px; }
    </style>
</head>

<body>
    <h1>SSH pubkey authentication test</h1>
    <form>
        <p>
        <label for="username">Username (UTF-8):</label><br>
        <input type="text" id="username" name="username" value="alfred@test.linkedin.com">
        </p>

        <p>
        <label for="challenge">Challenge (hex):</label><br>
        <input type="text" id="challenge" name="challenge" value="2969b93cc402dd4612158ff180b8a61ef2e12dcb88770459a039b851f1000ced">
        </p>

        <p>
        <label for="request_url">Request URL:</label><br>
        <input type="text" id="request_url" name="request_url" value="https://eat1-app45.corp.linkedin.com:8443/uas/login-submit">
        </p>

        <p>
        <label for="privatekey">Private key (PEM):</label><br>
        <textarea id="privatekey" name="privatekey">-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,C20284DFE2574C53BAF2C73072F99995

BmocszCeDrK1GWwqGEr5jU+VnpdG1mRkdYXQ1EKTWfW35fCLLOl/KZyFe7TF6fuM
NDK8vaCVCFBKKyfcftPga9jwCuZHvENjYPjj7Pds/iAwjYsxx77Jk4Xd1ulaSYlm
idOssZs5DllpG2P+UfVS8XH+Te+4Xw7+1Mx7m9OJA9PKM6H/5jIC+XJuRNMTEt8h
Rie1+8io+BFsk0wnURDcVwRmvBr0VaZuRoOCZB9UmCHS0bXUVDivkFRUr7YZ0vJm
BS8KFzHV8/H8IFvXQvsOczm4iGp7RvYO7mJ27H/ffQFukE44Dh1K5SbBdF4xSadK
Ly7btSyvPCT2QFeJdxcF/9TDJDbUaySxXp67x5eY2OGeS6M67ZxTsFOMI0IOEmkX
isxQXpt29iwyBi0vqmw9Q7yJgT+MRHekTCCozEiW9s9yuKUea1jsJ92bgHaP177J
pQ3JRhtWJBN2faKpsrLGcnKjTGgRZTJR6tkIiNkmd2tmIjB7m5ViKVIJz0Yoz8xf
IxF6kJWMBKnx/VitGxKXUb9y8zrBn9TTn2YE9Ag8YyxjLAs/HkKfmQb0nc43Pf0W
NEhdrmRC9IYI93M/+oZneJjw7ix4PPFLOoNhJ272zALDb8EhkadSSl/fDks3RXmI
XzZVjNlRDROiM49xxYjINSGhBKYR5t6TG/RnvqyVqVpzgQ4X43XBNkMFHdm5tcB1
bRas12EfdpgGmDsYCcj2YulH+0tj56fDw8lmOOrkVYQZO8hmRJYrJPXNPoE53UEN
XjhBvYCsWDBltgZJqWfLLDIJ9Q118332m+oS2W6Q+gMlcdlRzvVpZcruIc6jz0SS
WgJC/vpuKCF+8MDwO8OCGO6Vd+3CJeyJdMFAEaGZi6LLU+FZsaR3yC4ddieop5Mi
ZCUoewWoBlbgD8DB6lhlaz9VwW4nc7yJKVLGWXQxycJpcbjbMf9SscKvyScA7/wF
405Y31u59NRafGrJtsvipd8DYK+al7cWCsBUJU4G9QNnAlOVQBbxUnf7VgbhC1xz
DLZZScLcLIsVPBUzHXPgr5TZLTqjrKFVAGI4C6yMJW7R9r56J4LLgXxAj9Nls93j
CTBZZEoneu6V4tGNNCh8dE9rsXb7Szz9bFZKjhoIbVXEpSbCta0+m0JYsRvMMdMt
bQJtJaJBoY4zaIvI9pweE+3UI7NFXBxG23sZ/NJYnpR/wNoo6Qi1JvWxh+Q1cgoO
+BOBvvhuugCz653K2ETIGqrvWhwSpNGWLfG260+1ia7/cSDljHr6jESRAEaqRqIP
A4ENfGSrzpJJ+6gO08+3lKMwJTGpcbnJxB/dBZzSBZSu86E1/b/Ry9dV9biIhOSU
1HPuXF3ULJJZYzApnTt6AH/vJMncYrV8flB/YfApXoYixaNBKTg0h2K38H5vysti
RPiYIReVWKaSqg7sAJa03SPJx5tbblAmwz4fd4JXmjFpbAuQvSy1cYwfSkjn4Rk4
VVFqtqud9MYzVWLBX1EZ3Nd6nSC9UsVUtza3Wzs5lWgNev/9rzIu99SKPW9nRclM
5eD+BFd+EDtrsjPsjfHFru5B9rJCq9LfKDenghbfTTKoQMYj2y3toNYrcETzMvhv
-----END RSA PRIVATE KEY-----
</textarea>
        </p>

        <p>
        <label for="passphrase">Passphrase:</label><br>
        <input type="text" id="passphrase" name="passphrase" value="password">
        </p>

        <p>
        <label for="publickey">Public key (RFC4253):</label><br>
        <textarea id="publickey" name="publickey"></textarea>
        </p>

        <p>
        <label for="signature">Authentication request (base64):</label><br>
        <textarea id="authrequest" name="authrequest"></textarea>
        </p>
    </form>
</body>
